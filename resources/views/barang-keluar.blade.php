
<x-layout>
    <x-slot:title>{{ $title }}</x-slot:title>

    <section class="content">
        <div class="container-fluid">
          <div class="row">
            <div class="col-12">
  
                <div class="card">
                    <div class="card-header row">
                        <h3 class="card-title col"></h3>
                        <button type="button" class="btn btn-block btn-primary col-sm-2">
                            <i class="fas fa-plus"></i>
                            Tambah Barang
                        </button>
                      </div>
                    <!-- /.card-header -->
                    <div class="card-body">
                      <table id="example1" class="table table-bordered table-striped">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>Kode</th>
                                <th>Tanggal</th>
                                <th>Nama Barang</th>
                                <th>QTY</th>
                                <th>Satuan</th>
                                <th>Harga</th>
                                <th>Jumlah</th>
                                <th>Keterangan</th>
                                <th>Tempat</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>SMP</td>
                                <td>27/12/2024</td>
                                <td>SEMEN MERAH PUTIH</td>
                                <td>30</td>
                                <td>SAK</td>
                                <td>Rp81.000</td>
                                <td>Rp2.430.000</td>
                                <td></td>
                                <td>Apartemen</td>
                            </tr>
                            <tr>
                                <td>1</td>
                                <td>SMP</td>
                                <td>27/12/2024</td>
                                <td>SEMEN MERAH PUTIH</td>
                                <td>30</td>
                                <td>SAK</td>
                                <td>Rp81.000</td>
                                <td>Rp2.430.000</td>
                                <td></td>
                                <td>Apartemen</td>
                            </tr>
                            <tr>
                                <td>1</td>
                                <td>SMP</td>
                                <td>27/12/2024</td>
                                <td>SEMEN MERAH PUTIH</td>
                                <td>30</td>
                                <td>SAK</td>
                                <td>Rp81.000</td>
                                <td>Rp2.430.000</td>
                                <td></td>
                                <td>Apartemen</td>
                            </tr>
                            <tr>
                                <td>1</td>
                                <td>SMP</td>
                                <td>27/12/2024</td>
                                <td>SEMEN MERAH PUTIH</td>
                                <td>30</td>
                                <td>SAK</td>
                                <td>Rp81.000</td>
                                <td>Rp2.430.000</td>
                                <td></td>
                                <td>Apartemen</td>
                            </tr>
                            <tr>
                                <td>1</td>
                                <td>SMP</td>
                                <td>27/12/2024</td>
                                <td>SEMEN MERAH PUTIH</td>
                                <td>30</td>
                                <td>SAK</td>
                                <td>Rp81.000</td>
                                <td>Rp2.430.000</td>
                                <td></td>
                                <td>Apartemen</td>
                            </tr>
                            <tr>
                                <td>1</td>
                                <td>SMP</td>
                                <td>27/12/2024</td>
                                <td>SEMEN MERAH PUTIH</td>
                                <td>30</td>
                                <td>SAK</td>
                                <td>Rp81.000</td>
                                <td>Rp2.430.000</td>
                                <td></td>
                                <td>Apartemen</td>
                            </tr>
                            <tr>
                                <td>1</td>
                                <td>SMP</td>
                                <td>27/12/2024</td>
                                <td>SEMEN MERAH PUTIH</td>
                                <td>30</td>
                                <td>SAK</td>
                                <td>Rp81.000</td>
                                <td>Rp2.430.000</td>
                                <td></td>
                                <td>Apartemen</td>
                            </tr>
                            <tr>
                                <td>1</td>
                                <td>SMP</td>
                                <td>27/12/2024</td>
                                <td>SEMEN MERAH PUTIH</td>
                                <td>30</td>
                                <td>SAK</td>
                                <td>Rp81.000</td>
                                <td>Rp2.430.000</td>
                                <td></td>
                                <td>Apartemen</td>
                            </tr>
                            <tr>
                                <td>1</td>
                                <td>SMP</td>
                                <td>27/12/2024</td>
                                <td>SEMEN MERAH PUTIH</td>
                                <td>30</td>
                                <td>SAK</td>
                                <td>Rp81.000</td>
                                <td>Rp2.430.000</td>
                                <td></td>
                                <td>Apartemen</td>
                            </tr>
                            <tr>
                                <td>1</td>
                                <td>SMP</td>
                                <td>27/12/2024</td>
                                <td>SEMEN MERAH PUTIH</td>
                                <td>30</td>
                                <td>SAK</td>
                                <td>Rp81.000</td>
                                <td>Rp2.430.000</td>
                                <td></td>
                                <td>Apartemen</td>
                            </tr>
                            <tr>
                                <td>1</td>
                                <td>SMP</td>
                                <td>27/12/2024</td>
                                <td>SEMEN MERAH PUTIH</td>
                                <td>30</td>
                                <td>SAK</td>
                                <td>Rp81.000</td>
                                <td>Rp2.430.000</td>
                                <td></td>
                                <td>Apartemen</td>
                            </tr>
                            <tr>
                                <td>1</td>
                                <td>SMP</td>
                                <td>27/12/2024</td>
                                <td>SEMEN MERAH PUTIH</td>
                                <td>30</td>
                                <td>SAK</td>
                                <td>Rp81.000</td>
                                <td>Rp2.430.000</td>
                                <td></td>
                                <td>Apartemen</td>
                            </tr>
                        </tbody>
                      </table>
                    </div>
                    <!-- /.card-body -->
                  </div>
              <!-- /.card -->
            </div>
            <!-- /.col -->
          </div>
          <!-- /.row -->
        </div>
        <!-- /.container-fluid -->
      </section>

      <x-slot:script>
        <script>
            $(function () {
                $("#example1").DataTable({
                    "responsive": true,
                    "lengthChange": false,
                    "autoWidth": false,
                    "ordering": false,
                    "columnDefs": [
                    { "width": "20px", "targets": 0 } // Mengatur lebar kolom pertama (indeks 0) menjadi 20px
                    ],
                    "buttons": [
                        {
                            "extend": 'excel',
                            "text": '<i class="fa-solid fa-download"></i> Export',
                            "className": 'btn btn-success btn-sm',
                            "title": "REKAPAN TOTAL",
                            "messageTop": "Periode Desember 2022",
                            "customize": function (xlsx) {
                                const sheet = xlsx.xl.worksheets['sheet1.xml'];
                                
                                // Tambahkan border ke semua sel
                                $('row c', sheet).attr('s', '2'); // Style index 2 untuk border
                                
                                // Tambahkan total
                                const total = $('#totalJumlah').text();
                                const lastRow = $('row:last', sheet).attr('r');
                                const newRow = parseInt(lastRow) + 1;
                                
                                $('row:last', sheet).after(`
                                    <row r="${newRow}">
                                        <c t="inlineStr" r="A${newRow}" s="3">
                                            <is><t>Total</t></is>
                                        </c>
                                        <c r="D${newRow}" t="n" s="4">
                                            <v>${total.replace(/[^\d]/g, '')}</v>
                                        </c>
                                    </row>
                                `);

                                // Tambahkan style number format
                                $('xf:applyNumberFormats', sheet).attr('count', '2');
                            }
                        }
                    ],
                }).buttons().container().appendTo('#example1_wrapper .col-md-6:eq(0)');
            });
        </script>
      </x-slot:script>

</x-layout>